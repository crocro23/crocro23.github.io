const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CwICu4CC.js","../chunks/BkpA0PSA.js","../chunks/BCZbx2Sk.js","../chunks/tbjhAa6l.js"])))=>i.map(i=>d[i]);
import{b as W,_ as H}from"../chunks/gqh83yNy.js";import{i as J}from"../chunks/B_5HCC-R.js";import{o as K}from"../chunks/Be08vJ07.js";import{p as Q,i as l,j as X,k as j,g as a,l as n,f as A,h as Y,t as I,b as T,c as ee,a as te,$ as re,s as f,d as c,u as oe,e as O,n as ae,r as d}from"../chunks/BCZbx2Sk.js";import{s as se,a as ie,b as ne}from"../chunks/BLwdxzQt.js";import{s as le,a as ce}from"../chunks/DYPfjpQk.js";import{b as p}from"../chunks/DFIzvCNj.js";import{A as de}from"../chunks/U59SA10y.js";import{A as me}from"../chunks/CB_PO8Uy.js";import{A as pe}from"../chunks/L4UoILjp.js";import{$ as ue}from"../chunks/BkpA0PSA.js";var he=A('<meta name="description"/> <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>',1),fe=A('<div class="bg-box/60 absolute inset-0 z-1000 flex items-center justify-center backdrop-blur-sm"><div class="relative max-w-sm"><!> <!></div></div>'),ge=A('<div class="space-y-8"><header><h1 class="text-primary mb-2 text-3xl font-bold"> </h1> <p class="text-lg"> </p></header> <!> <div class="border-primary relative overflow-hidden border"><div class="w-full"></div> <!></div></div>');function Ce(R,z){Q(z,!0);const g=()=>ce(ue,"$_",D),[D,S]=le();let F=oe(()=>z.data.projects),C=l("all"),E=l(""),u=l(X([])),P=l(void 0),_,o,v=l(null),m=[],h=l(0),k=l("600px");j(()=>{if(a(h)>0){const e=`${Math.max(600,Math.min(600,a(h)*.5))}px`;if(e!==a(k)&&(n(k,e),o)){const r=o.getBounds();requestAnimationFrame(()=>{requestAnimationFrame(()=>{o.invalidateSize(!0),r&&o.fitBounds(r)})})}}}),K(async()=>{n(h,window.innerHeight,!0);let t;const e=()=>{clearTimeout(t),t=setTimeout(()=>{const s=window.innerHeight;s!==a(h)&&n(h,s,!0)},100)};window.addEventListener("resize",e);const r=await H(()=>import("../chunks/CwICu4CC.js").then(s=>s.l),__vite__mapDeps([0,1,2,3]),import.meta.url);delete r.Icon.Default.prototype._getIconUrl,r.Icon.Default.mergeOptions({iconRetinaUrl:`${p}/marker-icon@2x.png`,iconUrl:`${p}/marker-icon.png`,shadowUrl:`${p}/marker-shadow.png`}),o=r.map(_,{center:[46.603354,1.888334],zoom:6,zoomControl:!0,scrollWheelZoom:!1,doubleClickZoom:!0,touchZoom:!0,dragging:!0}),r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors",className:"map-tiles"}).addTo(o);const i=document.createElement("style");return i.textContent=`
			.map-tiles {
				filter: grayscale(100%);
			}
		`,document.head.appendChild(i),setTimeout(()=>{L()},100),()=>{window.removeEventListener("resize",e),o&&o.remove()}}),j(()=>{const t=a(u);o&&t&&L()});async function L(){if(!o)return;const t=await H(()=>import("../chunks/CwICu4CC.js").then(e=>e.l),__vite__mapDeps([0,1,2,3]),import.meta.url);if(m.forEach(e=>o.removeLayer(e)),m=[],console.log("Updating markers for",a(u).length,"projects"),a(u).forEach(e=>{if(console.log("Processing project:",e.title,"coordinates:",e.coordinates),e.coordinates&&Array.isArray(e.coordinates)&&e.coordinates.length===2){const[r,i]=e.coordinates;console.log("Creating marker at",r,i);try{const s=e.featured?{iconUrl:`${p}/marker-featured.png`,iconRetinaUrl:`${p}/marker-featured@2x.png`,shadowUrl:`${p}/marker-shadow.png`,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}:void 0,$=s?t.marker([r,i],{title:e.title,icon:t.icon(s)}).addTo(o):t.marker([r,i],{title:e.title}).addTo(o);$.on("click",()=>{n(v,e,!0)}),$.bindTooltip(e.title,{permanent:!1,direction:"top"}),m.push($),console.log("Marker created successfully")}catch(s){console.error("Error creating marker:",s)}}}),console.log("Created",m.length,"markers"),m.length>0){const e=t.featureGroup(m);o.fitBounds(e.getBounds().pad(.1))}else o.setView([46.603354,1.888334],6)}function V(){n(v,null)}var b=ge();Y(t=>{var e=he(),r=te(e);ae(2),I((i,s)=>{re.title=`${se.title} • ${i??""}`,ie(r,"content",s)},[()=>g()("pages.map.title"),()=>g()("pages.map.description")]),T(t,e)});var w=c(b),y=c(w),Z=c(y,!0);d(y);var U=f(y,2),q=c(U,!0);d(U),d(w);var M=f(w,2);me(M,{get projects(){return a(F)},get searchTerm(){return a(E)},set searchTerm(t){n(E,t,!0)},get selectedType(){return a(C)},set selectedType(t){n(C,t,!0)},get filteredProjects(){return a(u)},set filteredProjects(t){n(u,t,!0)},get handler(){return a(P)},set handler(t){n(P,t,!0)}});var B=f(M,2),x=c(B);W(x,t=>_=t,()=>_);var G=f(x,2);{var N=t=>{var e=fe(),r=c(e),i=c(r);pe(i,{class:"absolute -top-2 -right-2",onclick:V});var s=f(i,2);de(s,{get project(){return a(v)}}),d(r),d(e),T(t,e)};J(G,t=>{a(v)&&t(N)})}d(B),d(b),I((t,e)=>{O(Z,t),O(q,e),ne(x,`height: ${a(k)??""}; max-height: 80vh;`)},[()=>g()("pages.map.title"),()=>g()("pages.map.description")]),T(R,b),ee(),S()}export{Ce as component};
